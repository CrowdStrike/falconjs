/* tslint:disable */
/* eslint-disable */
/**
 * CrowdStrike API Specification
 * Use this API specification as a reference for the API endpoints you can use to interact with your Falcon environment. These endpoints support authentication via OAuth2 and interact with detections and network containment. For detailed usage guides and examples, see our [documentation inside the Falcon console](https://falcon.crowdstrike.com/support/documentation).     To use the APIs described below, combine the base URL with the path shown for each API endpoint. For commercial cloud customers, your base URL is `https://api.crowdstrike.com`.    Each API endpoint requires authorization via an OAuth2 token. Your first API request should retrieve an OAuth2 token using the `oauth2/token` endpoint, such as `https://api.crowdstrike.com/oauth2/token`. For subsequent requests, include the OAuth2 token in an HTTP authorization header. Tokens expire after 30 minutes, after which you should make a new token request to continue making API requests.
 *
 * The version of the OpenAPI document: rolling
 *
 *
 * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).
 * https://openapi-generator.tech
 * Do not edit the class manually.
 */

import * as runtime from "../runtime";
import type {
    MsaReplyMetaOnly,
    MsaspecResponseFields,
    RestAWSAccountCreateRequestExtv1,
    RestAWSAccountCreateResponseExtV1,
    RestAWSAccountPatchRequestExtV1,
    RestAWSAccountQueryResponseExtV1,
    RestAWSAccountValidationResponse,
    RestAWSHealthCheckTriggerResponseExtV1,
} from "../models/index";
import {
    MsaReplyMetaOnlyFromJSON,
    MsaReplyMetaOnlyToJSON,
    MsaspecResponseFieldsFromJSON,
    MsaspecResponseFieldsToJSON,
    RestAWSAccountCreateRequestExtv1FromJSON,
    RestAWSAccountCreateRequestExtv1ToJSON,
    RestAWSAccountCreateResponseExtV1FromJSON,
    RestAWSAccountCreateResponseExtV1ToJSON,
    RestAWSAccountPatchRequestExtV1FromJSON,
    RestAWSAccountPatchRequestExtV1ToJSON,
    RestAWSAccountQueryResponseExtV1FromJSON,
    RestAWSAccountQueryResponseExtV1ToJSON,
    RestAWSAccountValidationResponseFromJSON,
    RestAWSAccountValidationResponseToJSON,
    RestAWSHealthCheckTriggerResponseExtV1FromJSON,
    RestAWSHealthCheckTriggerResponseExtV1ToJSON,
} from "../models/index";

export interface CloudAwsRegistrationApiCloudRegistrationAwsCreateAccountRequest {
    body: RestAWSAccountCreateRequestExtv1;
}

export interface CloudAwsRegistrationApiCloudRegistrationAwsDeleteAccountRequest {
    ids?: Array<string>;
    organizationIds?: Array<string>;
}

export interface CloudAwsRegistrationApiCloudRegistrationAwsGetAccountsRequest {
    ids?: Array<string>;
    organizationIds?: Array<string>;
}

export interface CloudAwsRegistrationApiCloudRegistrationAwsQueryAccountsRequest {
    products: Array<string>;
    features: Array<string>;
    organizationIds?: Array<string>;
    accountStatus?: CloudRegistrationAwsQueryAccountsAccountStatusEnum;
    limit?: number;
    offset?: number;
    groupBy?: CloudRegistrationAwsQueryAccountsGroupByEnum;
}

export interface CloudAwsRegistrationApiCloudRegistrationAwsTriggerHealthCheckRequest {
    accountIds?: Array<string>;
    organizationIds?: Array<string>;
}

export interface CloudAwsRegistrationApiCloudRegistrationAwsUpdateAccountRequest {
    body: RestAWSAccountPatchRequestExtV1;
}

export interface CloudAwsRegistrationApiCloudRegistrationAwsValidateAccountsRequest {
    accountId?: string;
    iamRoleArn?: string;
    organizationId?: string;
}

/**
 *
 */
export class CloudAwsRegistrationApi extends runtime.BaseAPI {
    /**
     * Creates a new account in our system for a customer.
     */
    async cloudRegistrationAwsCreateAccountRaw(
        requestParameters: CloudAwsRegistrationApiCloudRegistrationAwsCreateAccountRequest,
        initOverrides?: RequestInit | runtime.InitOverrideFunction,
    ): Promise<runtime.ApiResponse<RestAWSAccountCreateResponseExtV1>> {
        if (requestParameters["body"] == null) {
            throw new runtime.RequiredError("body", 'Required parameter "body" was null or undefined when calling cloudRegistrationAwsCreateAccount().');
        }

        const queryParameters: any = {};

        const headerParameters: runtime.HTTPHeaders = {};

        headerParameters["Content-Type"] = "application/json";

        if (this.configuration && this.configuration.accessToken) {
            // oauth required
            headerParameters["Authorization"] = await this.configuration.accessToken("oauth2", ["cloud-aws-registration:write"]);
        }

        const response = await this.request(
            {
                path: `/cloud-security-registration-aws/entities/account/v1`,
                method: "POST",
                headers: headerParameters,
                query: queryParameters,
                body: RestAWSAccountCreateRequestExtv1ToJSON(requestParameters["body"]),
            },
            initOverrides,
        );

        return new runtime.JSONApiResponse(response, (jsonValue) => RestAWSAccountCreateResponseExtV1FromJSON(jsonValue));
    }

    /**
     * Creates a new account in our system for a customer.
     */
    async cloudRegistrationAwsCreateAccount(body: RestAWSAccountCreateRequestExtv1, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<RestAWSAccountCreateResponseExtV1> {
        const response = await this.cloudRegistrationAwsCreateAccountRaw({ body: body }, initOverrides);
        return await response.value();
    }

    /**
     * Deletes an existing AWS account or organization in our system.
     */
    async cloudRegistrationAwsDeleteAccountRaw(
        requestParameters: CloudAwsRegistrationApiCloudRegistrationAwsDeleteAccountRequest,
        initOverrides?: RequestInit | runtime.InitOverrideFunction,
    ): Promise<runtime.ApiResponse<MsaspecResponseFields>> {
        const queryParameters: any = {};

        if (requestParameters["ids"] != null) {
            queryParameters["ids"] = requestParameters["ids"];
        }

        if (requestParameters["organizationIds"] != null) {
            queryParameters["organization-ids"] = requestParameters["organizationIds"];
        }

        const headerParameters: runtime.HTTPHeaders = {};

        if (this.configuration && this.configuration.accessToken) {
            // oauth required
            headerParameters["Authorization"] = await this.configuration.accessToken("oauth2", ["cloud-aws-registration:write"]);
        }

        const response = await this.request(
            {
                path: `/cloud-security-registration-aws/entities/account/v1`,
                method: "DELETE",
                headers: headerParameters,
                query: queryParameters,
            },
            initOverrides,
        );

        return new runtime.JSONApiResponse(response, (jsonValue) => MsaspecResponseFieldsFromJSON(jsonValue));
    }

    /**
     * Deletes an existing AWS account or organization in our system.
     */
    async cloudRegistrationAwsDeleteAccount(ids?: Array<string>, organizationIds?: Array<string>, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<MsaspecResponseFields> {
        const response = await this.cloudRegistrationAwsDeleteAccountRaw({ ids: ids, organizationIds: organizationIds }, initOverrides);
        return await response.value();
    }

    /**
     * Retrieve existing AWS accounts by account IDs or organization IDs
     */
    async cloudRegistrationAwsGetAccountsRaw(
        requestParameters: CloudAwsRegistrationApiCloudRegistrationAwsGetAccountsRequest,
        initOverrides?: RequestInit | runtime.InitOverrideFunction,
    ): Promise<runtime.ApiResponse<RestAWSAccountCreateResponseExtV1>> {
        const queryParameters: any = {};

        if (requestParameters["ids"] != null) {
            queryParameters["ids"] = requestParameters["ids"];
        }

        if (requestParameters["organizationIds"] != null) {
            queryParameters["organization-ids"] = requestParameters["organizationIds"];
        }

        const headerParameters: runtime.HTTPHeaders = {};

        if (this.configuration && this.configuration.accessToken) {
            // oauth required
            headerParameters["Authorization"] = await this.configuration.accessToken("oauth2", ["cloud-aws-registration:read"]);
        }

        const response = await this.request(
            {
                path: `/cloud-security-registration-aws/entities/account/v1`,
                method: "GET",
                headers: headerParameters,
                query: queryParameters,
            },
            initOverrides,
        );

        return new runtime.JSONApiResponse(response, (jsonValue) => RestAWSAccountCreateResponseExtV1FromJSON(jsonValue));
    }

    /**
     * Retrieve existing AWS accounts by account IDs or organization IDs
     */
    async cloudRegistrationAwsGetAccounts(
        ids?: Array<string>,
        organizationIds?: Array<string>,
        initOverrides?: RequestInit | runtime.InitOverrideFunction,
    ): Promise<RestAWSAccountCreateResponseExtV1> {
        const response = await this.cloudRegistrationAwsGetAccountsRaw({ ids: ids, organizationIds: organizationIds }, initOverrides);
        return await response.value();
    }

    /**
     * Retrieve existing AWS accounts by account IDs
     */
    async cloudRegistrationAwsQueryAccountsRaw(
        requestParameters: CloudAwsRegistrationApiCloudRegistrationAwsQueryAccountsRequest,
        initOverrides?: RequestInit | runtime.InitOverrideFunction,
    ): Promise<runtime.ApiResponse<RestAWSAccountQueryResponseExtV1>> {
        if (requestParameters["products"] == null) {
            throw new runtime.RequiredError("products", 'Required parameter "products" was null or undefined when calling cloudRegistrationAwsQueryAccounts().');
        }

        if (requestParameters["features"] == null) {
            throw new runtime.RequiredError("features", 'Required parameter "features" was null or undefined when calling cloudRegistrationAwsQueryAccounts().');
        }

        const queryParameters: any = {};

        if (requestParameters["organizationIds"] != null) {
            queryParameters["organization-ids"] = requestParameters["organizationIds"];
        }

        if (requestParameters["products"] != null) {
            queryParameters["products"] = requestParameters["products"];
        }

        if (requestParameters["features"] != null) {
            queryParameters["features"] = requestParameters["features"];
        }

        if (requestParameters["accountStatus"] != null) {
            queryParameters["account-status"] = requestParameters["accountStatus"];
        }

        if (requestParameters["limit"] != null) {
            queryParameters["limit"] = requestParameters["limit"];
        }

        if (requestParameters["offset"] != null) {
            queryParameters["offset"] = requestParameters["offset"];
        }

        if (requestParameters["groupBy"] != null) {
            queryParameters["group_by"] = requestParameters["groupBy"];
        }

        const headerParameters: runtime.HTTPHeaders = {};

        if (this.configuration && this.configuration.accessToken) {
            // oauth required
            headerParameters["Authorization"] = await this.configuration.accessToken("oauth2", ["cloud-aws-registration:read"]);
        }

        const response = await this.request(
            {
                path: `/cloud-security-registration-aws/queries/account/v1`,
                method: "GET",
                headers: headerParameters,
                query: queryParameters,
            },
            initOverrides,
        );

        return new runtime.JSONApiResponse(response, (jsonValue) => RestAWSAccountQueryResponseExtV1FromJSON(jsonValue));
    }

    /**
     * Retrieve existing AWS accounts by account IDs
     */
    async cloudRegistrationAwsQueryAccounts(
        products: Array<string>,
        features: Array<string>,
        organizationIds?: Array<string>,
        accountStatus?: CloudRegistrationAwsQueryAccountsAccountStatusEnum,
        limit?: number,
        offset?: number,
        groupBy?: CloudRegistrationAwsQueryAccountsGroupByEnum,
        initOverrides?: RequestInit | runtime.InitOverrideFunction,
    ): Promise<RestAWSAccountQueryResponseExtV1> {
        const response = await this.cloudRegistrationAwsQueryAccountsRaw(
            { products: products, features: features, organizationIds: organizationIds, accountStatus: accountStatus, limit: limit, offset: offset, groupBy: groupBy },
            initOverrides,
        );
        return await response.value();
    }

    /**
     * Trigger health check scan for AWS accounts
     */
    async cloudRegistrationAwsTriggerHealthCheckRaw(
        requestParameters: CloudAwsRegistrationApiCloudRegistrationAwsTriggerHealthCheckRequest,
        initOverrides?: RequestInit | runtime.InitOverrideFunction,
    ): Promise<runtime.ApiResponse<RestAWSHealthCheckTriggerResponseExtV1>> {
        const queryParameters: any = {};

        if (requestParameters["accountIds"] != null) {
            queryParameters["account-ids"] = requestParameters["accountIds"];
        }

        if (requestParameters["organizationIds"] != null) {
            queryParameters["organization-ids"] = requestParameters["organizationIds"];
        }

        const headerParameters: runtime.HTTPHeaders = {};

        if (this.configuration && this.configuration.accessToken) {
            // oauth required
            headerParameters["Authorization"] = await this.configuration.accessToken("oauth2", ["cloud-aws-registration:read"]);
        }

        const response = await this.request(
            {
                path: `/cloud-security-registration-aws/entities/account-scans/v1`,
                method: "POST",
                headers: headerParameters,
                query: queryParameters,
            },
            initOverrides,
        );

        return new runtime.JSONApiResponse(response, (jsonValue) => RestAWSHealthCheckTriggerResponseExtV1FromJSON(jsonValue));
    }

    /**
     * Trigger health check scan for AWS accounts
     */
    async cloudRegistrationAwsTriggerHealthCheck(
        accountIds?: Array<string>,
        organizationIds?: Array<string>,
        initOverrides?: RequestInit | runtime.InitOverrideFunction,
    ): Promise<RestAWSHealthCheckTriggerResponseExtV1> {
        const response = await this.cloudRegistrationAwsTriggerHealthCheckRaw({ accountIds: accountIds, organizationIds: organizationIds }, initOverrides);
        return await response.value();
    }

    /**
     * Patches a existing account in our system for a customer.
     */
    async cloudRegistrationAwsUpdateAccountRaw(
        requestParameters: CloudAwsRegistrationApiCloudRegistrationAwsUpdateAccountRequest,
        initOverrides?: RequestInit | runtime.InitOverrideFunction,
    ): Promise<runtime.ApiResponse<RestAWSAccountCreateResponseExtV1>> {
        if (requestParameters["body"] == null) {
            throw new runtime.RequiredError("body", 'Required parameter "body" was null or undefined when calling cloudRegistrationAwsUpdateAccount().');
        }

        const queryParameters: any = {};

        const headerParameters: runtime.HTTPHeaders = {};

        headerParameters["Content-Type"] = "application/json";

        if (this.configuration && this.configuration.accessToken) {
            // oauth required
            headerParameters["Authorization"] = await this.configuration.accessToken("oauth2", ["cloud-aws-registration:write"]);
        }

        const response = await this.request(
            {
                path: `/cloud-security-registration-aws/entities/account/v1`,
                method: "PATCH",
                headers: headerParameters,
                query: queryParameters,
                body: RestAWSAccountPatchRequestExtV1ToJSON(requestParameters["body"]),
            },
            initOverrides,
        );

        return new runtime.JSONApiResponse(response, (jsonValue) => RestAWSAccountCreateResponseExtV1FromJSON(jsonValue));
    }

    /**
     * Patches a existing account in our system for a customer.
     */
    async cloudRegistrationAwsUpdateAccount(body: RestAWSAccountPatchRequestExtV1, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<RestAWSAccountCreateResponseExtV1> {
        const response = await this.cloudRegistrationAwsUpdateAccountRaw({ body: body }, initOverrides);
        return await response.value();
    }

    /**
     * Validates the AWS account registration status, and discover organization child accounts if organization is specified
     */
    async cloudRegistrationAwsValidateAccountsRaw(
        requestParameters: CloudAwsRegistrationApiCloudRegistrationAwsValidateAccountsRequest,
        initOverrides?: RequestInit | runtime.InitOverrideFunction,
    ): Promise<runtime.ApiResponse<RestAWSAccountValidationResponse>> {
        const queryParameters: any = {};

        if (requestParameters["accountId"] != null) {
            queryParameters["account-id"] = requestParameters["accountId"];
        }

        if (requestParameters["iamRoleArn"] != null) {
            queryParameters["iam-role-arn"] = requestParameters["iamRoleArn"];
        }

        if (requestParameters["organizationId"] != null) {
            queryParameters["organization-id"] = requestParameters["organizationId"];
        }

        const headerParameters: runtime.HTTPHeaders = {};

        if (this.configuration && this.configuration.accessToken) {
            // oauth required
            headerParameters["Authorization"] = await this.configuration.accessToken("oauth2", ["cloud-aws-registration:read"]);
        }

        const response = await this.request(
            {
                path: `/cloud-security-registration-aws/entities/account/validate/v1`,
                method: "POST",
                headers: headerParameters,
                query: queryParameters,
            },
            initOverrides,
        );

        return new runtime.JSONApiResponse(response, (jsonValue) => RestAWSAccountValidationResponseFromJSON(jsonValue));
    }

    /**
     * Validates the AWS account registration status, and discover organization child accounts if organization is specified
     */
    async cloudRegistrationAwsValidateAccounts(
        accountId?: string,
        iamRoleArn?: string,
        organizationId?: string,
        initOverrides?: RequestInit | runtime.InitOverrideFunction,
    ): Promise<RestAWSAccountValidationResponse> {
        const response = await this.cloudRegistrationAwsValidateAccountsRaw({ accountId: accountId, iamRoleArn: iamRoleArn, organizationId: organizationId }, initOverrides);
        return await response.value();
    }
}

/**
 * @export
 */
export const CloudRegistrationAwsQueryAccountsAccountStatusEnum = {
    Provisioned: "provisioned",
    Operational: "operational",
} as const;
export type CloudRegistrationAwsQueryAccountsAccountStatusEnum = (typeof CloudRegistrationAwsQueryAccountsAccountStatusEnum)[keyof typeof CloudRegistrationAwsQueryAccountsAccountStatusEnum];
/**
 * @export
 */
export const CloudRegistrationAwsQueryAccountsGroupByEnum = {
    Organization: "organization",
} as const;
export type CloudRegistrationAwsQueryAccountsGroupByEnum = (typeof CloudRegistrationAwsQueryAccountsGroupByEnum)[keyof typeof CloudRegistrationAwsQueryAccountsGroupByEnum];
